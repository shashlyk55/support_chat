<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <div class="show-popup-btn" id="show-popup-btn">
        <img class="icon" id="icon" src="source/svg/close_btn.svg" alt="">
        <input type="checkbox" onchange="changeIcon()" id="show-popup-checkbox">
    </div>

    <div class="sidepop-up dark">
        <div class="head">
            <div class="container">
                <div class="profile">
                    <div class="profile-avatar">
                        <img src="source/avatar.png" alt="profile_avatar">
                    </div>
                    <div class="profile-info">
                        <p class="username">Менеджер Валентин</p>
                        <span class="user-status">
                            <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="3" cy="3" r="3" fill="#11CABE"/>
                            </svg>    
                            <p>Онлайн</p>
                        </span>
                    </div>
                </div>
                <div class="close-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18.8894 17.2728L11.6163 9.99971L18.8894 2.72661C19.1037 2.51229 19.2242 2.2216 19.2242 1.91849C19.2242 1.61539 19.1037 1.3247 18.8894 1.11037C18.6751 0.896042 18.3844 0.775635 18.0813 0.775635C17.7782 0.775635 17.4875 0.896042 17.2732 1.11037L10.0001 8.38347L2.72698 1.11037C2.51265 0.896042 2.22196 0.775635 1.91886 0.775635C1.61575 0.775635 1.32506 0.896042 1.11074 1.11037C0.896409 1.3247 0.776002 1.61539 0.776002 1.91849C0.776002 2.2216 0.896409 2.51229 1.11074 2.72661L8.38383 9.99971L1.11074 17.2728C0.896409 17.4871 0.776001 17.7778 0.776001 18.0809C0.776001 18.384 0.896409 18.6747 1.11074 18.8891C1.32506 19.1034 1.61575 19.2238 1.91886 19.2238C2.22196 19.2238 2.51265 19.1034 2.72698 18.8891L10.0001 11.616L17.2732 18.8891C17.4875 19.1034 17.7782 19.2238 18.0813 19.2238C18.3844 19.2238 18.6751 19.1034 18.8894 18.8891C19.1037 18.6747 19.2242 18.384 19.2242 18.0809C19.2242 17.7778 19.1037 17.4871 18.8894 17.2728Z" fill="white"/>
                    </svg>
                </div>
            </div>
        </div>
        <div class="chat">
            <div class="date">Сегодня</div>
            <div class="messages" id="chat-container">
                <!-- If chat is empty -->
                <!--<div class="empty-chat">
                    Отправьте нам сообщение.<br>Мы ответим Вам в ближайшее время!
                </div>-->

                <!-- If chat has messages -->
                <div class="message-container">
                    <div class="message-group">
                        <div class="message">
                            Hello, I’m experiencing an issue with my account. Could you please help me resolve it?
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:48
                        </span>
                        <div class="sender-avatar">
                            <img src="source/svg/user_avatar.svg" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container" data-support-team-msg>
                    <div class="message-group">
                        <div class="message">
                            Of course! I’d be happy to assist you. Could you please describe the problem you’re having?               
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/avatar.png" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container">
                    <div class="message-group">
                        <div class="message">
                            Sure.
                        </div>
                        <div class="message">
                            Every time I try, I receive an “incorrect password” message, even though I’m sure the password is correct.                        
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/svg/user_avatar.svg" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container" data-support-team-msg>
                    <div class="message-group">
                        <div class="message">
                            Thank you for the information. Have you tried resetting your password yet?  
                            <!-- Pinned voice message -->  
                            <!--<div class="voice-msg-container">
                                <div class="play-voice-msg-btn">
                                    <img src="source/svg/play_voice_msg.svg" alt="play_voice">
                                </div>
                                <div class="waves">
                                    <div style="height: 10px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 6px;"></div>
                                    <div style="height: 11px;"></div>
                                    <div style="height: 8px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 15px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 6px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 11px;"></div>
                                    <div style="height: 12px;"></div>
                                    <div style="height: 14px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 14px;"></div>
                                    <div style="height: 8px;"></div>
                                    <div style="height: 14px;"></div>
                                </div>
                                <div class="timer">
                                    <span>00:24</span>
                                </div>
                                <div class="delete-msg-btn">
                                    <img src="source/svg/delete_msg.svg" alt="delete_voice">
                                </div>
                            </div>-->              
                            <!-- Pinned document -->
                            <!--<div class="doc-container">
                                <div class="open-doc-btn">
                                    <img src="source/svg/document.svg" alt="doc">
                                </div>
                                <div class="doc-info">
                                    <span class="doc-name">Screenshot 2024-10-21</span>
                                    <span class="doc-size">32kB</span>
                                </div>
                                <div class="delete-msg-btn">
                                    <img src="source/svg/delete_msg.svg" alt="delete_voice">
                                </div>
                            </div>-->
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/avatar.png" alt="user">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="message-input">
            <div class="msg-input-fields">
                <!-- Recording voice message -->
                <!--<div class="voice-msg-container">
                    <div class="waves">
                        <div style="height: 10px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 15px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:24</span>
                    </div>
                </div>-->
                
                <!-- Recorded voice message -->
                <!--<div class="voice-msg-container">
                    <div class="play-voice-msg-btn">
                        <img src="source/svg/play_voice_msg.svg" alt="play_voice">
                    </div>
                    <div class="waves">
                        <div style="height: 10px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 15px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:24</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->

                <!-- Play voice message -->
                <!--<div class="voice-msg-container">
                    <div class="play-voice-msg-btn">
                        <img src="source/svg/pause_voice_msg.svg" alt="play_voice">
                    </div>
                    <div class="waves">
                        <div style="height: 10px;background-color: #006fff;"></div>
                        <div style="height: 18px;background-color: #006fff;"></div>
                        <div style="height: 6px;background-color: #006fff;"></div>
                        <div style="height: 11px;background-color: #006fff;"></div>
                        <div style="height: 8px;background-color: #006fff;"></div>
                        <div style="height: 18px;background-color: #006fff;"></div>
                        <div style="height: 15px;background-color: #006fff;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:10/00:24</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->

                <!-- Send document -->
                <!--<div class="doc-container">
                    <div class="open-doc-btn">
                        <img src="source/svg/document.svg" alt="doc">
                    </div>
                    <div class="doc-info">
                        <span class="doc-name">Screenshot 2024-10-21</span>
                        <span class="doc-size">32kB</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->
            
                <!-- Text message -->
                <div class="input-field">
                    <textarea class="input-message" id="input-message" placeholder="Введите свое сообщение..."></textarea>
                </div>
            </div>
            <div class="buttons">
                <!-- Recording voice message -->
                <!--<div>
                    <img src="source/svg/record_voice_msg.svg" alt="record_voice_msg">
                </div>-->
                <!-- Write text message -->
                <div>
                    <img src="source/svg/voice_msg.svg" alt="voice_msg">
                </div>
                <div>
                    <img src="source/svg/pin_msg_btn.svg" alt="pin_msg">
                </div>
                <div onclick="sendMessage()">
                    <img src="source/svg/send_msg_btn.svg" alt="send_btn">
                </div>
            </div>
        </div>
    </div>

</body>
<script>
    function changeIcon(){
        const checkbox = document.getElementById('show-popup-checkbox')
        const icon = document.getElementById('icon')
            
        if(checkbox.checked) {
            icon.src = 'source/svg/show_popup_btn.svg'
        } else {
            icon.src = 'source/svg/close_btn.svg'
        }
    }

    const inputMessage = document.querySelector('.input-message')
        
    function adjustHeight() {
        inputMessage.style.height = 'auto'; // Сбрасываем высоту, чтобы пересчитать
        let scrollHeight = inputMessage.scrollHeight;
        
        if (scrollHeight > (window.innerWidth > 375 ? 144 : 108) ) { // 6 строк по 24px каждая (line-height = 24px)
            inputMessage.style.height = window.innerWidth > 375 ? '144px' : '108px'; // Ограничиваем высоту на 6 строк
            inputMessage.style.overflowY = 'auto'; // Появится прокрутка, если текст больше
        } else {
            inputMessage.style.height = scrollHeight + 'px'; // Подстраиваем высоту под контент
            inputMessage.style.overflowY = 'hidden'; // Убираем прокрутку, если не нужна
        }
    }
    inputMessage.addEventListener('input', adjustHeight)


    function createElement(opts = {}) {
        let ele = document.createElement('div');
        if('class' in opts) {
            if(!Array.isArray(opts.class)) {
                opts.class = [ opts.class ];
            }
            ele.classList.add(...opts.class);
        }
        return ele;
    }

    function sendMessage() {
        
        console.log('send message');
        
        const chatContainer = document.getElementById('chat-container')
        const messageText = inputMessage.value.trim()

        if(messageText === '') return

        const message = createElement({ class: 'message' })
        message.textContent = messageText

        const currentDate = new Date()
        const hours = String(currentDate.getHours()).padStart(2, '0')
        const minutes = String(currentDate.getMinutes()).padStart(2, '0')
        const sendingTime = `${hours}:${minutes}`
        
        const messageContainers = document.getElementsByClassName('message-container')
        const lastMessageContainer = messageContainers[messageContainers.length - 1]

        if(lastMessageContainer.hasAttribute('data-support-team-msg')) {
            const messageContainer = createElement({ class: 'message-container' })
            const messageGroup = createElement({ class: 'message-group' })
            messageGroup.appendChild(message)

            const senderContainer = createElement({ class: 'sender' })
            const sendTime = createElement({ class: 'send-time' })
            const senderAvatar = createElement({ class: 'sender-avatar'})
            senderAvatar.innerHTML+= '<img src="source/svg/user_avatar.svg" alt="user">'
            
            sendTime.textContent = sendingTime

            senderContainer.appendChild(sendTime)
            senderContainer.appendChild(senderAvatar)

            messageContainer.appendChild(messageGroup)
            messageContainer.appendChild(senderContainer)

            chatContainer.appendChild(messageContainer)
            
        } else {
            const messageGroup = lastMessageContainer.querySelector('.message-group')
            messageGroup.appendChild(message)

            lastMessageContainer.querySelector('.send-time').textContent = sendingTime
        }
        
        chatContainer.scrollTop = chatContainer.scrollHeight

        inputMessage.value = ''
        inputMessage.style.height = 'auto'
    }

    

    /*function animateIn(ele) {
        let delay = 35; // Небольшая задержка для корректного запуска анимации
        
        setTimeout(() => {
            ele.style.opacity = 1;
            ele.style.transform = 'translateX(0px) scale(1)';
        }, delay);

        let otherEleList = [ele];
        
        // Применяем дополнительные эффекты к другим элементам внутри сообщения
        delay += 40;
        
        otherEleList.forEach((e) => {
            setTimeout(() => {
                e.style.opacity = 1;
                e.style.transform = 'translateY(0px)';
            }, delay += 50);
        });
    }*/

</script>
</html>