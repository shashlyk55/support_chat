<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    
    <div class="sidepop-up dark">
        <div class="head">
            <div class="container">
                <div class="profile">
                    <div class="profile-avatar">
                        <img src="source/avatar.png" alt="profile_avatar">
                    </div>
                    <div class="profile-info">
                        <p class="username">Менеджер Валентин</p>
                        <span class="user-status">
                            <svg width="6" height="6" viewBox="0 0 6 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="3" cy="3" r="3" fill="#11CABE"/>
                            </svg>    
                            <p>Онлайн</p>
                        </span>
                    </div>
                </div>
                <div class="close-btn">
                    <img src="source/svg/close_btn.svg" alt="close_btn">
                </div>
            </div>
        </div>
        <div class="chat">
            <div class="date">Сегодня</div>
            <div class="messages" id="chat-container">
                <!-- If chat is empty -->
                <!--<div class="empty-chat">
                    Отправьте нам сообщение.<br>Мы ответим Вам в ближайшее время!
                </div>-->

                <!-- If chat has messages -->
                <div class="message-container">
                    <div class="message-group">
                        <div class="message">
                            Hello, I’m experiencing an issue with my account. Could you please help me resolve it?
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:48
                        </span>
                        <div class="sender-avatar">
                            <img src="source/svg/user_avatar.svg" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container" data-support-team-msg>
                    <div class="message-group">
                        <div class="message">
                            Of course!                    
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/avatar.png" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container">
                    <div class="message-group">
                        <div class="message">
                            Sure.
                        </div>
                        <div class="message">
                            Every time I try, I receive an “incorrect password” message, even though I’m sure the password is correct.                    
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/svg/user_avatar.svg" alt="user">
                        </div>
                    </div>
                </div>
                <div class="message-container" data-support-team-msg>
                    <div class="message-group">
                        <div class="message">
                            Thank you for the information. Have you tried resetting your password yet?  
                            <!-- Pinned voice message -->  
                            <!--<div class="voice-msg-container">
                                <div class="play-voice-msg-btn">
                                    <img src="source/svg/play_voice_msg.svg" alt="play_voice">
                                </div>
                                <div class="waves">
                                    <div style="height: 10px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 6px;"></div>
                                    <div style="height: 11px;"></div>
                                    <div style="height: 8px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 15px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 6px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 11px;"></div>
                                    <div style="height: 12px;"></div>
                                    <div style="height: 14px;"></div>
                                    <div style="height: 18px;"></div>
                                    <div style="height: 10px;"></div>
                                    <div style="height: 14px;"></div>
                                    <div style="height: 8px;"></div>
                                    <div style="height: 14px;"></div>
                                </div>
                                <div class="timer">
                                    <span>00:24</span>
                                </div>
                                <div class="delete-msg-btn">
                                    <img src="source/svg/delete_msg.svg" alt="delete_voice">
                                </div>
                            </div>-->              
                            <!-- Pinned document -->
                            <!--<div class="doc-container">
                                <div class="open-doc-btn">
                                    <img src="source/svg/document.svg" alt="doc">
                                </div>
                                <div class="doc-info">
                                    <span class="doc-name">Screenshot 2024-10-21</span>
                                    <span class="doc-size">32kB</span>
                                </div>
                                <div class="delete-msg-btn">
                                    <img src="source/svg/delete_msg.svg" alt="delete_voice">
                                </div>
                            </div>-->
                        </div>
                    </div>
                    <div class="sender">
                        <span class="send-time">
                            13:47
                        </span>
                        <div class="sender-avatar">
                            <img src="source/avatar.png" alt="user">
                        </div>
                    </div>
                </div>
                

            </div>
        </div>
        <div class="message-input">
            
            <div class="msg-input-fields">
                <!-- Recording voice message -->
                <!--<div class="voice-msg-container">
                    <div class="waves">
                        <div style="height: 10px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 15px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:24</span>
                    </div>
                </div>-->
                
                <!-- Recorded voice message -->
                <!--<div class="voice-msg-container">
                    <div class="play-voice-msg-btn">
                        <img src="source/svg/play_voice_msg.svg" alt="play_voice">
                    </div>
                    <div class="waves">
                        <div style="height: 10px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 15px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:24</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->

                <!-- Play voice message -->
                <!--<div class="voice-msg-container">
                    <div class="play-voice-msg-btn">
                        <img src="source/svg/pause_voice_msg.svg" alt="play_voice">
                    </div>
                    <div class="waves">
                        <div style="height: 10px;background-color: #006fff;"></div>
                        <div style="height: 18px;background-color: #006fff;"></div>
                        <div style="height: 6px;background-color: #006fff;"></div>
                        <div style="height: 11px;background-color: #006fff;"></div>
                        <div style="height: 8px;background-color: #006fff;"></div>
                        <div style="height: 18px;background-color: #006fff;"></div>
                        <div style="height: 15px;background-color: #006fff;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 6px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 11px;"></div>
                        <div style="height: 12px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 18px;"></div>
                        <div style="height: 10px;"></div>
                        <div style="height: 14px;"></div>
                        <div style="height: 8px;"></div>
                        <div style="height: 14px;"></div>
                    </div>
                    <div class="timer">
                        <span>00:10/00:24</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->

                <!-- Send document -->
                <!--<div class="doc-container">
                    <div class="open-doc-btn">
                        <img src="source/svg/document.svg" alt="doc">
                    </div>
                    <div class="doc-info">
                        <span class="doc-name">Screenshot 2024-10-21</span>
                        <span class="doc-size">32kB</span>
                    </div>
                    <div class="delete-msg-btn">
                        <img src="source/svg/delete_msg.svg" alt="delete_voice">
                    </div>
                </div>-->
            
                <!-- Text message -->
                <div class="input-field">
                    <textarea class="input-message" id="input-message" placeholder="Введите свое сообщение..."></textarea>
                </div>
            </div>
            
            
            <div class="buttons">
                <!-- Recording voice message -->
                <!--<div>
                    <img src="source/svg/record_voice_msg.svg" alt="record_voice_msg">
                </div>-->
                <!-- Write text message -->
                <div>
                    <img src="source/svg/voice_msg.svg" alt="voice_msg">
                </div>
                <div>
                    <img src="source/svg/pin_msg_btn.svg" alt="pin_msg">
                </div>
                <div onclick="sendMessage()">
                    <img src="source/svg/send_msg_btn.svg" alt="send_btn">
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    const inputMessage = document.querySelector('.input-message')
        
    function adjustHeight() {
        inputMessage.style.height = 'auto'; // Сбрасываем высоту, чтобы пересчитать
        let scrollHeight = inputMessage.scrollHeight;
        
        if (scrollHeight > (window.innerWidth > 375 ? 144 : 108) ) { // 6 строк по 24px каждая (line-height = 24px)
            inputMessage.style.height = window.innerWidth > 375 ? '144px' : '108px'; // Ограничиваем высоту на 6 строк
            inputMessage.style.overflowY = 'auto'; // Появится прокрутка, если текст больше
        } else {
            inputMessage.style.height = scrollHeight + 'px'; // Подстраиваем высоту под контент
            inputMessage.style.overflowY = 'hidden'; // Убираем прокрутку, если не нужна
        }
    }
    inputMessage.addEventListener('input', adjustHeight)


    function createElement(opts = {}) {
        let ele = document.createElement('div');
        if('class' in opts) {
            if(!Array.isArray(opts.class)) {
                opts.class = [ opts.class ];
            }
            ele.classList.add(...opts.class);
        }
        return ele;
    }

    function sendMessage() {
        
        console.log('send message');
        
        const chatContainer = document.getElementById('chat-container')
        const messageText = inputMessage.value.trim()

        if(messageText === '') return

        const message = createElement({ class: 'message' })
        message.textContent = messageText

        const currentDate = new Date()
        const hours = String(currentDate.getHours()).padStart(2, '0')
        const minutes = String(currentDate.getMinutes()).padStart(2, '0')
        const sendingTime = `${hours}:${minutes}`
        
        const messageContainers = document.getElementsByClassName('message-container')
        const lastMessageContainer = messageContainers[messageContainers.length - 1]

        if(lastMessageContainer.hasAttribute('data-support-team-msg')) {
            const messageContainer = createElement({ class: 'message-container' })
            const messageGroup = createElement({ class: 'message-group' })
            messageGroup.appendChild(message)

            const senderContainer = createElement({ class: 'sender' })
            const sendTime = createElement({ class: 'send-time' })
            const senderAvatar = createElement({ class: 'sender-avatar'})
            senderAvatar.innerHTML+= '<img src="source/svg/user_avatar.svg" alt="user">'
            
            sendTime.textContent = sendingTime

            senderContainer.appendChild(sendTime)
            senderContainer.appendChild(senderAvatar)

            messageContainer.appendChild(messageGroup)
            messageContainer.appendChild(senderContainer)

            chatContainer.appendChild(messageContainer)
            
        } else {
            const messageGroup = lastMessageContainer.querySelector('.message-group')
            messageGroup.appendChild(message)

            lastMessageContainer.querySelector('.send-time').textContent = sendingTime
        }
        
        chatContainer.scrollTop = chatContainer.scrollHeight

        inputMessage.value = ''
        inputMessage.style.height = 'auto'
    }

    

    /*function animateIn(ele) {
        let delay = 35; // Небольшая задержка для корректного запуска анимации
        
        setTimeout(() => {
            ele.style.opacity = 1;
            ele.style.transform = 'translateX(0px) scale(1)';
        }, delay);

        let otherEleList = [ele];
        
        // Применяем дополнительные эффекты к другим элементам внутри сообщения
        delay += 40;
        
        otherEleList.forEach((e) => {
            setTimeout(() => {
                e.style.opacity = 1;
                e.style.transform = 'translateY(0px)';
            }, delay += 50);
        });
    }*/

</script>
</html>